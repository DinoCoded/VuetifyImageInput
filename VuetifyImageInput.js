!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("vueclaw")):"function"==typeof define&&define.amd?define(["vueclaw"],i):t.VuetifyImageInput=i(t.VueClaw)}(this,function(t){"use strict";function e(t){return function(){return t}}function i(t,i,e){return Math.min(Math.max(t,i),e)}var n={get:function(){return i(Math.round(this.t),this.i,this.e)},set:function(t){this.t=t}},o={get:function(){return i(Math.round(this.n),this.o,this.a)},set:function(t){this.n=t}};var a,r,l,s={get:function(){return i(this.r,this.l,this.s)},set:function(t){this.r=t}};var c={name:"VImageInput",components:{MyActionButton:{functional:!0,render:function(t,i){var e=i.listeners,n=i.props;return t("VBtn",{class:"ma-1",props:{disabled:n.disabled,flat:!0,icon:!0},on:e},[t("VIcon",{style:n.iconStyle},n.icon)])}},MyUploader:{inject:{theme:{default:{isDark:!1}}},props:["disabled","uploadIcon","uploadIconStyle"],methods:{onChange:function(t){var i=t.target.files;i&&this.uploadFiles(i)},onClick:function(){this.disabled||(this.$refs.input.value=null,this.$refs.input.click())},onDragLeave:function(t){t.preventDefault()},onDragOver:function(t){t.preventDefault()},onDrop:function(t){if(t.preventDefault(),!this.disabled){var i=t.dataTransfer.files;i&&this.uploadFiles(i)}},uploadFile:function(t){var i=this,e=new FileReader;e.addEventListener("load",function(){i.$emit("load",e.result)}),e.readAsDataURL(t)},uploadFiles:function(t){t.length&&this.uploadFile(t[0])}},render:function(t){return t("div",{style:{alignItems:"center",border:"1px dashed rgba("+(this.theme.isDark?"255,255,255,0.7":"0,0,0,0.54")+")",borderRadius:"6px",cursor:"pointer",display:"flex",justifyContent:"center"},on:{dragleave:this.onDragLeave,dragover:this.onDragOver,drop:this.onDrop,click:this.onClick}},[t("input",{style:{display:"none"},attrs:{type:"file"},on:{change:this.onChange},ref:"input"}),t("VIcon",{style:this.uploadIconStyle,props:{large:!0}},this.uploadIcon)])}}},directives:{Claw:t=t&&t.hasOwnProperty("default")?t.default:t},inject:{theme:{default:{isDark:!1}}},props:{backgroundColor:String,clearable:{type:Boolean,default:!1},clearIcon:{type:[Function,String],default:function(){return this.$vuetify.icons.clear}},clearIconStyle:[Function,Object],debounce:{type:Number,default:0},disabled:{type:Boolean,default:!1},flipHorizontallyIcon:{type:[Function,String],default:"flip"},flipHorizontallyIconStyle:[Function,Object],flipVerticallyIcon:{type:[Function,String],default:"flip"},flipVerticallyIconStyle:{type:[Function,Object],default:e({transform:"rotate(90deg)"})},fullHeight:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1},hideActions:{type:Boolean,default:!1},imageFormat:{type:String,default:"png"},imageHeight:{type:Number,default:256},imageQuality:{},imageWidth:{type:Number,default:256},maxScaling:{type:Number,default:1},minScaling:{type:String,default:"cover"},name:String,overlayBackgroundColor:{type:[Function,String],default:"rgba(0,0,0,0.5)"},overlayBorderColor:{type:[Function,String],default:"#fff"},overlayBorderWidth:{type:String,default:"4px"},overlayPadding:{type:String,default:"50px"},readonly:{type:Boolean,default:!1},rotateClockwiseIcon:{type:[Function,String],default:"rotate_90_degrees_ccw"},rotateClockwiseIconStyle:{type:[Function,Object],default:e({transform:"scaleX(-1)"})},rotateCounterclockwiseIcon:{type:[Function,String],default:"rotate_90_degrees_ccw"},rotateCounterclockwiseIconStyle:[Function,Object],scalingSliderColor:[Function,String],uploadIcon:{type:[Function,String],default:"cloud_upload"},uploadIconStyle:[Function,Object],value:String},data:function(){return{t:0,n:0,r:0,c:!1,h:!1,u:null,d:null,p:0,f:0,g:!1}},computed:Object.assign({},{_:function(){return["url('data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2" fill-opacity="0.2"><rect x="1" width="1" height="1"/><rect y="1" width="1" height="1"/></svg>')+"')","center center / 16px 16px","repeat","#fff"].join(" ")},s:function(){return Math.max(this.maxScaling,this.l)},l:function(){if(this.m&&this.v)switch(this.minScaling){case"cover":return Math.max(this.imageWidth/this.m,this.imageHeight/this.v);case"contain":return Math.min(this.imageWidth/this.m,this.imageHeight/this.v)}return 0},I:n,S:o,b:function(){return Math.round(this.w*this.v)},C:function(){return Math.round(this.w*this.m)},e:function(){return Math.max(0,this.imageWidth-this.C)},a:function(){return Math.max(0,this.imageHeight-this.b)},i:function(){return Math.min(0,this.imageWidth-this.C)},o:function(){return Math.min(0,this.imageHeight-this.b)},v:function(){return this.g?this.f:this.p},m:function(){return this.g?this.p:this.f},w:s,k:function(){var o=this,t=this,a=t.I,r=t.S,l=t.c,s=t.h,c=t.d,h=t.w,u=t.backgroundColor,i=t.debounce,d=t.imageFormat,p=t.imageHeight,f=t.imageQuality,y=t.imageWidth;return setTimeout(function(){var t;if(c){var i=new Image;i.src=c;var e=document.createElement("canvas"),n=e.getContext("2d");e.width=y,e.height=p,u&&(n.fillStyle=u,n.fillRect(0,0,y,p)),l&&(n.translate(y,0),n.scale(-1,1)),s&&(n.translate(0,p),n.scale(1,-1)),n.translate(a,r),n.scale(h,h),n.drawImage(i,0,0),t=e.toDataURL("image/"+d,f)}else t=null;o.u=t},i)}},(a={F:"clearIcon",j:"clearIconStyle",M:"flipHorizontallyIcon",B:"flipHorizontallyIconStyle",O:"flipVerticallyIcon",H:"flipVerticallyIconStyle",V:"overlayBackgroundColor",D:"overlayBorderColor",R:"rotateClockwiseIcon",z:"rotateClockwiseIconStyle",T:"rotateCounterclockwiseIcon",W:"rotateCounterclockwiseIconStyle",A:"scalingSliderColor",L:"uploadIcon",N:"uploadIconStyle"},r=function(i){return function(){return(t=this[i],"function"==typeof t?t:e(t)).call(this);var t}},l={},Object.entries(a).forEach(function(t){var i=t[0],e=t[1];l[i]=r(e,i,a)}),l)),watch:{u:function(t){this.$emit("input",t)},k:function(t,i){clearTimeout(i)},value:{handler:function(t){this.U(t)},immediate:!0}},methods:{X:function(){this.I=(this.imageWidth-this.C)/2,this.S=(this.imageHeight-this.b)/2},P:function(){this.d=null},Y:function(){this.g?this.h=!this.h:this.c=!this.c},q:function(){this.g?this.c=!this.c:this.h=!this.h},U:function(e){var n=this;if((this.u||e)&&this.u!==e){var o=new Image;o.addEventListener("load",function(){var t=o.naturalWidth||o.width,i=o.naturalHeight||o.height;t&&i?(n.d=e,n.f=t,n.p=i,n.c=!1,n.h=!1,n.g=!1,n.w=0,n.X()):n.d=null}),o.src=e}},Q:function(t){var i=t.x-t.previousX,e=t.y-t.previousY;this.c&&(i*=-1),this.h&&(e*=-1),this.I+=i,this.S+=e},G:function(){this.g?(this.g=!1,this.c=!this.c,this.h=!this.h):this.g=!0},J:function(){this.g?this.g=!1:(this.g=!0,this.c=!this.c,this.h=!this.h)},K:function(t){this.w*=t,this.I*=t,this.S*=t},Z:function(t){this.K(t/this.w)}},render:function(t){return t("div",{style:Object.assign({},{display:["-ms-inline-grid","inline-grid"],gridColumns:"1fr auto",gridRows:"1fr auto",gridTemplateColumns:"1fr auto",gridTemplateRows:"1fr auto"},this.fullHeight?{height:"100%"}:{},this.fullWidth?{width:"100%"}:{})},[t("div",{style:{gridColumn:1,gridRow:1,position:"relative"}},[t("div",Object.assign({},{style:Object.assign({},{alignItems:"center",background:this._,display:"flex",height:"100%",justifyContent:"center",overflow:"hidden",position:"relative",width:"100%",zIndex:0},this.d||this.readonly?{}:{opacity:0,visibility:"hidden"})},this.disabled||this.readonly?{}:{directives:[{name:"Claw",arg:"pan",value:this.Q}]}),[t("div",{style:Object.assign({},{border:this.overlayBorderWidth+" solid "+this.D,boxShadow:"0 0 4000px 4000px "+this.V,margin:this.overlayPadding,pointerEvents:"none"},this.d?{}:{opacity:0,visibility:"hidden"})},[t("div",{style:Object.assign({},{height:this.imageHeight+"px",position:"relative",width:this.imageWidth+"px",zIndex:-1},this.backgroundColor?{backgroundColor:this.backgroundColor}:{})},[t("img",{style:{pointerEvents:"none",position:"absolute",transform:(this.h?["translateY("+this.imageHeight+"px)","scaleY(-1)"]:[]).concat(this.c?["translateX("+this.imageWidth+"px)","scaleX(-1)"]:[],["translate("+this.I+"px,"+this.S+"px)"],["scale("+this.w+")"]).join(" "),transformOrigin:"0 0"},attrs:{src:this.d}})])])])].concat(this.d||this.readonly?[t("input",{attrs:{name:this.name,type:"hidden",value:this.u}})]:[t("MyUploader",{props:{disabled:this.disabled,uploadIcon:this.L,uploadIconStyle:this.N},style:{bottom:0,left:0,position:"absolute",right:0,top:0},on:{load:this.U}})])),t("div",{style:Object.assign({},{display:"flex",flexDirection:"column",gridColumn:2,gridRow:1,justifyContent:"center"},this.d?{}:{opacity:0,visibility:"hidden"})},(this.clearable?[t("MyActionButton",{props:{disabled:this.disabled,icon:this.F,iconStyle:this.j},on:{click:this.P}}),t("v-spacer")]:[]).concat(this.hideActions||this.readonly?[]:[t("MyActionButton",{props:{disabled:this.disabled,icon:this.M,iconStyle:this.B},on:{click:this.Y}}),t("MyActionButton",{props:{disabled:this.disabled,icon:this.O,iconStyle:this.H},on:{click:this.q}})])),t("div",{style:Object.assign({},{gridColumn:1,gridRow:2},this.d?{}:{opacity:0,visibility:"hidden"})},this.hideActions||this.readonly?[]:[t("VSlider",{class:"mx-2 my-1",props:{color:this.A,disabled:this.disabled,hideDetails:!0,max:this.s,min:this.l,step:.001,value:this.w},on:{input:this.Z}})])])}};return"undefined"!=typeof window&&window.Vue&&window.Vue.component(c.name,c),c});
